<!DOCTYPE html>
<html>
    <head>
        <title>Memorability experiment</title>
        

      <link href="jspsych-6.3.1/css/jspsych.css" rel="stylesheet" type="text/css">
      <script src="jspsych-6.3.1/jspsych.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-preload.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-html-keyboard-response.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-survey-multi-choice.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-survey-multi-select.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-survey-text.js" type="text/javascript"></script> 
      <script src="jspsych-6.3.1/plugins/jspsych-categorize-image.js" type="text/javascript"></script> 
      <script src="jspsych-6.3.1/plugins/jspsych-fullscreen.js" type="text/javascript"></script>
      <script src="jspsych-6.3.1/plugins/jspsych-call-function.js" type="text/javascript"></script> 

    </head>
    <body>
      <script>
        
// PART I: WELCOME & INSTRUCTIONS
        /* create timeline array */
        //various arrays and other needed variables
        var timeline = [];
        var jpData;
        var prolificId;
        var reactionTime = [];
        var imageSequence = [];
        var answerInputs = [];
        var test_stimuli_shuffled = [];
        var test_stimuli_final = [];
        var test_stimuli_shuffled_strings = [];
        var answerArray = [];
        var trueFalseArray = [];
        var test_stimuli_memory_shuffled = [];
        var outStringStim;
        var outStringInputs;
        var outStringReaction;
        //Javascript version of HTML input elements, jsPsych overwrites HTML DOM for some reason so this workaround is necessary
        var form = document.createElement("form")
        var inputElement = document.createElement("input");
        var sequenceElement = document.createElement("input");
        var reactionElement = document.createElement("input");
        var responseMemElement = document.createElement("input");
        var sequenceMemElement = document.createElement("input");
        var reactionMemElement = document.createElement("input");
        var trueFalseMemElement = document.createElement("input");
        //end elementns
        //equivalent to setting up form post
        form.method = "POST";
        form.action = "familiarityratings.php";
        //equivalent to adding in the ids, names, and style to HTML elements   
        //start encoding elements
        sequenceElement.id = "stim";
        inputElement.id = "answers";
        reactionElement.id = "reaction";
        sequenceElement.name = "stimName";
        inputElement.name = "answersName";
        reactionElement.name = "reactionName";
        reactionElement.hidden = true;
        sequenceElement.hidden = true;
        inputElement.hidden = true;
        //end encoding elements
        //start memory test elements
        responseMemElement.id = "responseMem";
        sequenceMemElement.id = "stimMem";
        reactionMemElement.id = "reactionMem";
        trueFalseMemElement.id = "trueFalseMem";
        responseMemElement.name = "responseMemName";
        sequenceMemElement.name = "stimMemName";
        reactionMemElement.name = "reactionMemName";
        trueFalseMemElement.name = "trueFalseMemName";
        responseMemElement.hidden = true;
        sequenceMemElement.hidden = true;
        reactionMemElement.hidden = true;
        trueFalseMemElement.hidden = true;
        //end memory test elements
        
function shuffleArray(array) {
    for (var i = array.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
}
        /* preload all images 
        var preload = {
            type: 'preload',
            auto_preload: true
        }
        timeline.push(preload); */
  
        /* welcome message */
        var welcome = {
            type: "html-keyboard-response",
            stimulus: "<p>Welcome to the experiment!</p>" +
            "<p>Press any key to answer a few demographic questions.</p>" ,
            post_trial_gap: 150 // milliseconds
        }; 
        timeline.push(welcome);

        var PID_question = {
            type: "survey-text",
            questions: [
            {prompt: 'Please enter your Prolific ID:', name: 'PID', required: true}, 
            {prompt: 'How old are you?', name: 'Age', required: true}
            ]
        };
        timeline.push(PID_question);

        var gender_question = {
            type: "survey-multi-choice",
            questions: [
              {
                prompt: "What is your gender?", 
                name: 'Gender', 
                options: ['Male', 'Female', 'Other', 'Prefer not to answer'], 
                required: true
              }
            ],
        };
        timeline.push(gender_question);
 
         var race_question = {
            type: "survey-multi-select",
            questions: [
             {
                prompt: "What is your race? You may select more than one answer.", 
                name: 'Race', 
                options: ['American Indian/Native American', 'Asian', 'Native Hawaiian/Pacific Islander','Black/African American','White','Other','Prefer not to answer'], 
                required: true
              },
              {
                prompt: "What is your ethnicty?", 
                name: 'Ethnicity', 
                options: ['Hispanic or Latino', 'Not Hispanic or Latino'], 
                required: true
              }
            ],
        };
        timeline.push(race_question);
        
        /* instruction message */
        var instructions = {
            type: "html-keyboard-response",
            stimulus: `
            <p>Time for the task!</p>
            <p>In this experiment, you will see many different images of scenes. Each image is either <strong>memorable</strong> or <strong>forgettable</strong>. Memorable images were consistently remembered much more frequently by participants in previous studies than forgettable images.</p>
            <p>On each trial, you will see a new image. If you think the image is <strong>forgettable</strong>, press the letter <strong>F</strong> on the keyboard. If you think the image is <strong>memorable</strong>, press the letter <strong>J</strong>. After you make your guess, you will see the correct answer.</p>
            <p>We are interested in seeing if people can learn the difference between memorable and forgettable images. Therefore, we encourage you to incorporate past feedback when making your guesses.</p>
            <p>There will be 3 breaks during the experiment. There will also be a few trials to check that you are paying attention, where you will select whether the image is an <strong>inside</strong> or an <strong>outside</strong> scene.</p>
            <p>Press any key to begin.</p>
            `,
            post_trial_gap: 150 // milliseconds
        };
        timeline.push(instructions);
        
    // PART II: EXPERIMENTAL TRIALS
        var test_stimuli_forgettable = [
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/19_sun_auxibjrgylomwwhl_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/21_sun_ayizqeiakoltymuc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
           /* {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/24_sun_aiazdbafkaryuikh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/27_sun_acpxaistqyimycdc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/29_sun_aafblbfkfftldfxp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/30_sun_atyhjqokikabkszi_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/32_sun_akfvnliigcmmyjeg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/33_sun_aitovcbtirfhelra_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/33_sun_ayyinnoubjlehosy_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/34_sun_abbbbfhfjmdeltyl_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/34_sun_ahedpphfkwqjbbiv_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/35_sun_aavhjjwwicmitbbc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/35_sun_ajhucnhjegkkwfph_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/37_sun_aaajuldidvlcyzhv_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/37_sun_ahtmvwmmrlbrfchd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/37_sun_alwxdxldnifsfrwd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/38_sun_aanbqunhvxzlwdik_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/38_sun_aerhdhovmnfduswi_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/38_sun_aslpisizkmqugezu_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/39_sun_agjgmsknfgeelzeo_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/40_sun_axldphlqdnlehida_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/42_sun_aaadqildrtprdhcg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/42_sun_aeajtwxsftghiagd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/42_sun_awjgnxvwjqaykdvu_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/42_sun_azyxxwveybsehnlh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_abtrlibwejjxpdtp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_akbbxewfnuxtxfkd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_apjfvingpnwedfpr_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_aveviqphrvmhusav_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_azmpqaaqfzacyalx_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/43_sun_azrwnspaymvtdhau_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/44_sun_absrxewyonjapfvh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/44_sun_adytbpuddgttsoog_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/45_sun_aimyesuzsmiwvpfh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/45_sun_aowuzhihyufpxmrn_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/45_sun_bctdtcqciqgupefg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/46_sun_acnglfkffgdtuqjp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/46_sun_adnxatmmkemucooz_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/46_sun_aggtniazglwfjjxy_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/46_sun_aimeinfyfoxqhgki_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/46_sun_bvazhffigpnkxubv_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/47_sun_aaaxbrksvmdyrhpe_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/47_sun_abwpwiheytxshiqp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/47_sun_aehqefempiwsacye_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/48_sun_aaquttcuxwjcswwz_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/48_sun_adbwclmkgjaubwgc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/48_sun_afzcgngkkqtwbjen_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/48_sun_atovpzkbpokcfhrp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/48_sun_ayvqosroxbxnjhkx_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_aawmbcenogohrlen_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_acdowvgzvvzapzzc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_adifzmekqenrtahn_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_afxywfurnpdlxrki_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_aiwhrujmhdbquncx_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_ajnntxrmbbzdjmkn_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_ayevdsxpcttexfzt_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_bytuhfnudnbsojli_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/49_sun_dmoyxkhhlbzptiwh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/50_sun_abjkyoaboisttjmi_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/50_sun_aqkzegqxvdgdpomp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_abnfbsuqtgjqazwd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_aciuvbhvntkgdhhk_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_acukmokofsbuhbmg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_aeherdtnoxxjvwsm_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_amebtecagubzprpz_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_apvtpjdfgucfbnsd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_augjbsfiqnqcsbzf_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_ayncdmkodpmoufhg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_azygccampvagkgsw_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/51_sun_bvrxtezjptwimeml_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_abedxtnxfcacwczn_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_abegyiikvbaqpooh_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_acutmjpfsnbgmgdp_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_acypszvrjuogbryd_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_ashtwbbqfvraarza_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/52_sun_bpftdihpikymulxu_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_aaqpzrisirnbvubg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_aavzscilwnisdgkc_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_adbhvoczmttzjwdb_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_aqengtehhtetoqlq_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_auwfkswrpuoxtfnt_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_avvzajbehfbhnlpt_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_avyzsbjelxhawjgi_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_axdjnhjwqqxajaws_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_axptnwhdisbeobzo_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/53_sun_axulqcgeyuwcswpg_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/54_sun_aagikdebqbtavcvf_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/54_sun_acbtnwalhzdcufvb_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/54_sun_acwcoqgsueznibgo_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/ForgScenes90/54_sun_asnqkkyhilqkxiqm_crop.jpg", key_answer: 'f', text_answer: 'forgettable'},
      */];
          var test_stimuli_memorable = [
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_aaatjmlktzymikwf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_acjcvzqhwybsucmr_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
         /*   {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_akuitutqnebhfiqg_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_aqeihowlpdprvqfx_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_araqywvyndchlswi_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_ayjkfajqrwawjqrc_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/81_sun_biwjtjbrkjosclay_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_achcgztqnvhzvhxg_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_adiwlljpmliivkyf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_agtfdrcgyjcbtlvb_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_ainoacwsquefrlbr_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_ajvggicvmaklxxrm_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_aouixwxrvqihfhgs_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_asfazrpaywevtmdt_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_aunmtltahwcwdlqz_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_auqykplyynyhxcas_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_awifyqzzubihkywf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_awjnichhcaunlnrz_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_bgzlchzecrkjzgwv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/82_sun_btnbfazvlzumdfvi_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_aapydqezjoupuuig_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_abgodqrpbbcvtrzn_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_aeatifohhumxwnhp_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_afcsizyyyvbczdzq_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_ajcipjzqodfcekba_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_akyhpluahmjyrxpk_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_anaooaojimhclxkd_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_apgpwpqulgfxcqrz_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_aqgcopgqkxfdxadx_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_aqytiseksxuezunr_crop.jpg", key_answer: 'j', text_answer: 'memorable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_auxmasnxfejmtbxf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_axinksamqqkuscfi_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_azhaadgbytlosaat_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/83_sun_bxctqgbrjilpcbdc_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_aaptvgcjibmntaci_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_adjhjnhuhulqtkcq_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_airxobbhilzhuucf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_aknbqkyjmltzjpuf_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_amlirccuwuzhpdly_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_amltgebjganoiiih_crop.jpg", key_answer: 'j', text_answer: 'memorable'},             
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_avtprdrihxhgackd_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_avzdbzqhuqsqqaqs_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/84_sun_bzfmbqcmvdwoxayr_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_achskkahnssdgpub_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_agrbuzfpfrfvuoty_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_ajkmuktgalobrhte_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_atrmcfwybussnhdm_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_atvabkwxtkmfrgpg_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_avauwsvpzzujahyj_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_avrvgyanyrtbcaiy_crop.jpg", key_answer: 'j', text_answer: 'memorable'},             
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_avwenxrdoyocdspq_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_axouleovaunnvjjz_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_bcctyztqmvdkccfv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_bjqonbuarxjqsuqr_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_bpmjrniddcjldtii_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_bqtozbikfpfllurv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/85_sun_bsaotdiiwmauzdat_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_aadbmpmxxatythtm_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_aarowrwdgbkiftpi_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_apclutakotaszosq_crop.jpg", key_answer: 'j', text_answer: 'memorable'},             
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_apiharrkzncghpdz_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_apkdsqjzfpplctpg_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_apvmzzkwfayvhqop_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_arvgcdvzsulunfqt_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_atzvtjyanhvprtsv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/86_sun_azoztrocspdvuxab_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_aaoujiwgpfyplgmt_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_afybdrsfxcvfnwwv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_agxeguwfcuvtxkmn_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_amutkwizhjulrmic_crop.jpg", key_answer: 'j', text_answer: 'memorable'},             
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_anrsgsxkwchimlhw_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_asjekjrkafpjmizl_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/87_sun_awblohobvejbazmi_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/88_sun_abfzoyyzomxoeuxh_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/88_sun_abqzjgzspsrtykuo_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_aaikbnfeiupowbrw_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_acwzyvaxhvwpgpad_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_adsueslplqfnwvqd_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_ajjacdfzcematahl_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_apfagbhwyzrpjema_crop.jpg", key_answer: 'j', text_answer: 'memorable'},            
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/89_sun_apkyagytekpxaoeq_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/90_sun_asvzkstmwbolucer_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/90_sun_bbsdhludlztrcaxa_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/90_sun_bvllfilrpazbqbik_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/91_sun_akjjbhyrhvgqwbnv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/91_sun_auzzrfvsvotayjkv_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/91_sun_bbksirscbrssqoft_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/92_sun_auhkjmgiscerzvng_crop.jpg", key_answer: 'j', text_answer: 'memorable'},
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/93_sun_bksbkxqebrxharpc_crop.jpg", key_answer: 'j', text_answer: 'memorable'},          
            {stimulus: "http://wilmabainbridge.com/research/learningmem/MemScenes90/95_sun_axmeufyrptihxqbn_crop.jpg", key_answer: 'j', text_answer: 'memorable'} 
      */];
        /* This entire section is array manipulation for the two tasks in the experiment*/ 
        shuffleArray(test_stimuli_forgettable);
        shuffleArray(test_stimuli_memorable);
        var forgetLength = test_stimuli_forgettable.length;
        for (i = 0; i < (forgetLength)/2; i++){ //grab the first 45 of each array to use as stimuli, add them to an array
          test_stimuli_shuffled[test_stimuli_shuffled.length] = test_stimuli_forgettable.pop();
          test_stimuli_shuffled[test_stimuli_shuffled.length] = test_stimuli_memorable.pop();
        }
        shuffleArray(test_stimuli_shuffled); //shuffle the array 
        test_stimuli_memory_shuffled = JSON.parse(JSON.stringify(test_stimuli_shuffled)); //duplicate array for memory test (deep copy)
        for (j = 0; j < test_stimuli_memory_shuffled.length; j++){ //change the text and key values to a seen/unseen format
          test_stimuli_memory_shuffled[j].text_answer = 'seen';
          test_stimuli_memory_shuffled[j].key_answer = 'f';
          if (j < test_stimuli_forgettable.length){
            test_stimuli_forgettable[j].text_answer = 'unseen';
            test_stimuli_memorable[j].text_answer = 'unseen';
            test_stimuli_forgettable[j].key_answer = 'j';
            test_stimuli_memorable[j].key_answer = 'j';
          }
        }

        test_stimuli_memory_test = test_stimuli_memory_shuffled.concat(test_stimuli_forgettable,test_stimuli_memorable); //add in remaining stimuli as foils for memory test
        shuffleArray(test_stimuli_memory_test); //shuffle memory test array
      //end array manipulation
        
        /* fixation stimulus presentation */
        var fixation = {
            type: 'html-keyboard-response',
            stimulus: '<div style="font-size:60px;">+</div>',
            choices: jsPsych.NO_KEYS,
            trial_duration: 500
        };
  
        var trial_count = 0;
          
        var break_trial = {
          type: "html-keyboard-response",
          stimulus:  "<p>Time to take a break!</p>" + 
                  "<p>When you are ready to continue, press the space bar. </p>",
         choices: [' ']
        };
        
        var break_conditional = {
          timeline: [break_trial],
          conditional_function: function() {
            trial_count++;
            if (trial_count % 46 == 0) {
              // if the trial count is divisible by 46, then run the break trial (3 in total)
              return true;
            } else {
              // otherwise skip the break trial
              return false;
            }
          }
        };

        var attn_trial = {
          type: 'categorize-image',
          stimulus: function() {
            if (trial_count == 17) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/47_sun_aasftqkoqshqnfpa_crop.jpg";
            return stim;
            } else if (trial_count == 34) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/84_sun_afztbzvqscvktlao_crop.jpg";
            return stim;
            } else if (trial_count == 51) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/49_sun_agnarkcracmlnlhn_crop.jpg";
            return stim;
            } else if (trial_count == 68) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/86_sun_akodobunayijitjs_crop.jpg";
            return stim;
            } else if (trial_count == 85) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/49_sun_azzfxynzfaezuupp_crop.jpg";
            return stim;
            } else if (trial_count == 102) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/86_sun_auqolvrkszcwtshm_crop.jpg";
            return stim;
            } else if (trial_count == 119) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/51_sun_anrqfhmdscxifpze_crop.jpg";
            return stim;
            } else if (trial_count == 136) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/89_sun_ajujoqmxplrixpsc_crop.jpg";
            return stim;
            } else if (trial_count == 153) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/54_sun_apkqbofgcrmwisep_crop.jpg";
            return stim;
            } else if (trial_count == 170) {
              var stim = "http://wilmabainbridge.com/research/learningmem/AttnScenes/90_sun_avjkliqgjcmyzmgo_crop.jpg"; 
            return stim;
            }
          },
          key_answer: function() {
            if (trial_count == 17) {
              var ans = 'f';
            return ans;
            } else if (trial_count == 34) {
              var ans = 'f';
            return ans
            } else if (trial_count == 51) {
              var ans = 'j';
            return ans
            } else if (trial_count == 68) {
              var ans = 'j';
            return ans
            } else if (trial_count == 85) {
              var ans = 'f';
            return ans
            } else if (trial_count == 102) {
              var ans = 'j';
            return ans
            } else if (trial_count == 119) {
              var ans = 'j';
            return ans
            } else if (trial_count == 136) {
              var ans = 'f';
            return ans
            } else if (trial_count == 153) {
              var ans = 'j';
            return ans
            } else if (trial_count == 170) {
              var ans = 'f';
            return ans
            }
          },
          choices: ['f', 'j'],
          prompt: "<p><strong>Is this an inside scene (press F) or an outside scene (press J)?</strong></p>",
          show_stim_with_feedback: false
        };
        
        var attn_conditional = {
          timeline: [attn_trial],
          conditional_function: function() {
            if (trial_count % 17 == 0) {
              // if the trial count is divisible by 46, then run the break trial (3 in total)
              return true;
            } else {
              // otherwise skip the break trial
              return false;
            }
          }
        };

        var test_learn = {
            type: 'categorize-image',
            stimulus: jsPsych.timelineVariable('stimulus'),
            key_answer: jsPsych.timelineVariable('key_answer'),
            text_answer: jsPsych.timelineVariable('text_answer'),
            prompt: '<p style="color:white;">Placeholder</p>',
            choices: ['f', 'j'],
            correct_text:function() {
              if(jsPsych.pluginAPI.compareKeys(jsPsych.timelineVariable('text_answer'), "memorable")){
              var stim = '<p> <strong>Correct</strong>! This image is <strong style="color:blue;">'+jsPsych.timelineVariable('text_answer')+'</strong>. You answered <strong style="color:blue;">'+jsPsych.timelineVariable('text_answer')+'</strong>.</p>';
            return stim;
              } else if(jsPsych.pluginAPI.compareKeys(jsPsych.timelineVariable('text_answer'), "forgettable")){
                var stim = '<p> <strong>Correct</strong>! This image is <strong style="color:orange;">'+jsPsych.timelineVariable('text_answer')+'</strong>. You answered <strong style="color:orange;">'+jsPsych.timelineVariable('text_answer')+'</strong>.</p>';
            return stim;
              }
              },
            incorrect_text:function() {
              if(jsPsych.pluginAPI.compareKeys(jsPsych.timelineVariable('text_answer'), "memorable")){
              var stim = '<p><strong>Incorrect</strong>, this image is <strong style="color:blue;">'+jsPsych.timelineVariable('text_answer')+'</strong>. You answered <strong style="color:orange;">forgettable</strong>.</p>';
            return stim;
              } else if (jsPsych.pluginAPI.compareKeys(jsPsych.timelineVariable('text_answer'), "forgettable")) {
                var stim = '<p><strong>Incorrect</strong>, this image is <strong style="color:orange;">'+jsPsych.timelineVariable('text_answer')+'</strong>. You answered <strong style="color:blue;">memorable</strong>.</p>';
            return stim;
              }
              },
            show_stim_with_feedback: true,
            feedback_duration: 3000
        };
        var test_test = {
          type: 'categorize-image',
          stimulus: jsPsych.timelineVariable('stimulus'),
          key_answer: jsPsych.timelineVariable('key_answer'),
          text_answer: jsPsych.timelineVariable('text_answer'),
          prompt: '<p style="color:white;">Placeholder</p>',
          choices: ['f', 'j'],
          correct_text: function(){
              var stim = '<p style="color:white;">Placeholder</p>';
          },
          incorrect_text: function(){
              var stim = '<p style="color:white;">Placeholder</p>';
          },
          show_stim_with_feedback: false,
          feedback_duration: 0
        }

        var test_learn_procedure = {
            timeline: [fixation, break_conditional, attn_conditional, test_learn],
            timeline_variables: test_stimuli_shuffled,
            randomize_order: false
        };

       /* var test_test_procedure = {
          timeline: [fixation, test_test],
          timeline_variables: test_stimuli_final,
          randomize_order: false
        };*/

        timeline.push(test_learn_procedure);
        var instructionsMemoryTest = {
            type: "html-keyboard-response",
            stimulus: `
            <p>Time for the Part 2 of the Task!</p>
            <p>In this portion of the experiment, you will see many different images of scenes. Some of these images you have seen before in the earlier portion of the experiment, some you have not.</p>
            <p>On each trial, you will see an image. If you think you <strong> have </strong> seen the image in the previous portion of the study, press the letter <strong>F</strong> on the keyboard. If you think you <strong>have not</strong> seen the image in the previous portion of the study, press the letter <strong>J</strong>.</p>
            <p>We are interested in seeing if people can learn the difference between memorable and forgettable images, but unlike last time, you will not recieve feedback after each image, only a final score at the end. If you get over <strong>80%</strong> correct, you will recieve a small bonus payment.</p>
            <p>There will be 3 breaks during the experiment. There will also be a few trials to check that you are paying attention, where you will select whether the image is an <strong>inside</strong> or an <strong>outside</strong> scene.</p>
            <p>Press any key to begin.</p>
            `,
            post_trial_gap: 150 // milliseconds
        };
        timeline.push(instructionsMemoryTest);

        var memoryTestProcedure = {
          timeline: [fixation, break_conditional, attn_conditional, test_test],
          timeline_variables: test_stimuli_memory_test,
          randomize_order: false
        }
        timeline.push(memoryTestProcedure);
        
        var post_questions = {
          type: "survey-text",
          preamble: 'You have reached the end of the experiment! Please answer the following questions:',
          questions: [
            {prompt: '1. What do you think was the difference between memorable and forgettable scene images?', rows: 5},
            {prompt: '2. How, if at all, did your ideas about this difference change over the course of the experiment?', rows: 5},
            {prompt: '3. What strategies did you use to make your decisions?', rows: 5}
            ]
        };
        timeline.push(post_questions);
        
        var debrief_block = {
          type: "html-keyboard-response",
          stimulus: function() {
            
            var trials = jsPsych.data.get().filter({trial_type: 'categorize-image'});
            var correct_trials = trials.filter({correct: true});
            var percent_corr = Math.round(correct_trials.count() / trials.count() * 100); //percent of trials the subject got correct
            var fullData = jsPsych.data.get();
            //console.log(fullData.csv());

           
            return `<p>Thank you for participating! </p>
            <p>You responded correctly on ${percent_corr}% of trials.</p> 
            <p>Press any key to return to Prolific and complete the study.</p>`

          },
        };

        timeline.push(debrief_block);
        
         var complete_exp = {
            type: "call-function",
            async: true,
            func: function(done){
                var xhr = new XMLHttpRequest();
                xhr.open('POST', 'write_data.php');
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.onload = function() {
                if(xhr.status == 200){
                    var response = JSON.parse(xhr.responseText);
                    console.log(response.success);
                }
                done(); // invoking done() causes experiment to progress to next trial.
                };
                xhr.send(jsPsych.data.get().json());
            }
        };

        //timeline.push(complete_exp);  
 
  jsPsych.init({
            timeline: timeline,
            on_finish: function(){
              jpData = jsPsych.data.get().values();
              Advance();
            }
        })


function Advance(){
  prolificId = jpData[1].response.PID;
  var isEncode = true;
  var isMem = true;
  var k = 0;
  var q = 0;
  var memImgSequence = [];
  var memResponses = [];
  var memReactions = [];
  var memTrueFalse = [];
  while (isEncode == true){
    if (jpData[k].internal_node_id.includes('0.0-5.0-3')){ //internal node of the response for encoding portion
      imageSequence.push(jpData[k].stimulus, "#");
      answerInputs.push(jpData[k].response, "#");
      reactionTime.push(jpData[k].rt, "#");
    }
    if (jpData[k].internal_node_id.includes('0.0-5.0-3.1')){ //replace this with '0.0-5.0-3.89' for full trials final number is number of shown images-1  
      isEncode = false;
    }
    k++;
  }
  while (isMem == true){
    if (jpData[q].internal_node_id.includes('0.0-7.0-3')){
      memImgSequence.push(jpData[q].stimulus, "#");
      memResponses.push(jpData[q].response, "#");
      memReactions.push(jpData[q].rt, "#");
      memTrueFalse.push(jpData[q].correct, "#");
    }
    if (jpData[q].internal_node_id.includes('0.0-7.0-3.3')){ //replace numbers wuth '0.0-7.0-3.89' for full trial count
      isMem = false;
    }
    q++;
  }
  //join elements into one string
  outStringStim = imageSequence.join();
  outStringStim = outStringStim.replaceAll(',','');
  outStringInputs = answerInputs.join();
  outStringInputs = outStringInputs.replaceAll(',','');
  outStringReaction = reactionTime.join();
  outStringReaction = outStringReaction.replaceAll(',','');
  var outStringStimMem = memImgSequence.join();
  outStringStimMem = outStringStimMem.replaceAll(',','');
  var outStringResponsesMem = memResponses.join();
  outStringResponsesMem = outStringResponsesMem.replaceAll(',','');
  var outStringReactionMem = memReactions.join();
  outStringReactionMem = outStringReactionMem.replaceAll(',','');
  var outStringTrueFalseMem = memTrueFalse.join();
  outStringTrueFalseMem = outStringTrueFalseMem.replaceAll(',','');
  inputElement.value = outStringInputs;
  sequenceElement.value = outStringStim;
  reactionElement.value = outStringReaction;
  responseMemElement.value = outStringResponsesMem;
  sequenceMemElement.value = outStringStimMem;
  reactionMemElement.value = outStringReactionMem;
  trueFalseMemElement.value = outStringTrueFalseMem;
  form.appendChild(inputElement);
  form.appendChild(sequenceElement);
  form.appendChild(reactionElement);
  form.appendChild(responseMemElement);
  form.appendChild(sequenceMemElement);
  form.appendChild(reactionMemElement);
  form.appendChild(trueFalseMemElement);
  document.body.appendChild(form);
  
  toPHP();

  
}
function toPHP(){
  form.submit();
}
</script>  
</form>
</body> 
</html>